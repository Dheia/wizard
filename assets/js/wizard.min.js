var Wizard=function(e){function n(){var n=e(".wizard__body"),i=(e(".wizard__body--loading"),e(".wizard__body--exiting"),e("#wizard__drawer-trigger"));drawer_opened="wizard__drawer--open",setTimeout(function(){n.addClass("loaded")},100),i.on("click",function(){n.toggleClass(drawer_opened)}),e(".wizard__button--proceed:not(.wizard__button--closer)").click(function(e){e.preventDefault();var i=this.getAttribute("href");n.addClass("exiting"),setTimeout(function(){window.location=i},400)}),e(".wizard__button--closer").on("click",function(e){n.removeClass(drawer_opened),e.preventDefault();var i=this.getAttribute("href");setTimeout(function(){n.addClass("exiting")},600),setTimeout(function(){window.location=i},1100)}),e(".button-next").on("click",function(n){n.preventDefault();var i=a(this);if(!i)return!1;var t=e(this).data("callback");return!t||void 0===r[t]||(r[t](this),!1)}),e(document).on("change",".js-wizard-demo-import-select",function(){var n=e(this).val();e(".js-wizard-select-spinner").show(),e.post(wizard_params.ajaxurl,{action:"wizard_update_selected_import_data_info",wpnonce:wizard_params.wpnonce,selected_index:n},function(n){n.success?e(".js-wizard-drawer-import-content").html(n.data):alert(wizard_params.texts.something_went_wrong),e(".js-wizard-select-spinner").hide()}).fail(function(){e(".js-wizard-select-spinner").hide(),alert(wizard_params.texts.something_went_wrong)})})}function i(){function n(e){void 0!==e.done?(setTimeout(function(){o.addClass("lead")},0),setTimeout(function(){o.addClass("success"),o.html(e.message)},600),t()):(o.addClass("lead error"),o.html(e.error))}function i(){jQuery.post(wizard_params.ajaxurl,{action:"wizard_child_theme",wpnonce:wizard_params.wpnonce},n).fail(n)}var t,s=e(".wizard__body"),o=e("#child-theme-text");return{init:function(n){t=function(){setTimeout(function(){e(".wizard__body").addClass("js--finished")},1500),s.removeClass(drawer_opened),setTimeout(function(){e(".wizard__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=n.href},4e3)},i()}}}function t(){function n(n){void 0!==n.success&&n.success?(a.siblings(".error-message").remove(),setTimeout(function(){a.addClass("lead")},0),setTimeout(function(){a.addClass("success"),a.html(n.message)},600),t()):(e(".js-wizard-license-activate-button").removeClass("wizard__button--loading").data("done-loading","no"),a.siblings(".error-message").remove(),o.addClass("has-error"),a.html(n.message),a.siblings(".error-message").addClass("lead error"))}function i(){o.removeClass("has-error"),jQuery.post(wizard_params.ajaxurl,{action:"wizard_activate_license",wpnonce:wizard_params.wpnonce,license_key:e(".js-license-key").val()},n).fail(n)}var t,s=e(".wizard__body"),o=e(".wizard__content--license-key"),a=e("#license-text");return{init:function(n){t=function(){setTimeout(function(){e(".wizard__body").addClass("js--finished")},1500),s.removeClass(drawer_opened),setTimeout(function(){e(".wizard__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=n.href},4e3)},i()}}}function s(){function n(e){var s=o.find("label");"object"==typeof e&&void 0!==e.message?(s.removeClass("installing success error").addClass(e.message.toLowerCase()),void 0!==e.done&&e.done?t():void 0!==e.url?e.hash==d?(s.removeClass("installing success").addClass("error"),t()):(d=e.hash,jQuery.post(e.url,e,n).fail(n)):t()):i()}function i(){if(l){var e=o.find("input:checkbox");e.is(":checked")?jQuery.post(wizard_params.ajaxurl,{action:"wizard_plugins",wpnonce:wizard_params.wpnonce,slug:l},n).fail(n):(o.addClass("skipping"),setTimeout(t,300))}}function t(){o&&(o.data("done_item")||(r++,o.data("done_item",1)),o.find(".spinner").css("visibility","hidden"));var n=e(".wizard__drawer--install-plugins li");n.each(function(){var n=e(this);return!!n.data("done_item")||(l=n.data("slug"),o=n,i(),!1)}),r>=n.length&&s()}var s,o,a=e(".wizard__body"),r=0,l="",d="";return{init:function(n){e(".wizard__drawer--install-plugins").addClass("installing"),e(".wizard__drawer--install-plugins").find("input").prop("disabled",!0),s=function(){setTimeout(function(){e(".wizard__body").addClass("js--finished")},1e3),a.removeClass(drawer_opened),setTimeout(function(){e(".wizard__body").addClass("exiting")},3e3),setTimeout(function(){window.location.href=n.href},3500)},t()}}}function o(){function n(i){var s=l.find("label");"object"==typeof i&&void 0!==i.message?(s.addClass(i.message.toLowerCase()),void 0!==i.num_of_imported_posts&&0<p&&(f="all"===i.num_of_imported_posts?p:i.num_of_imported_posts,a()),void 0!==i.url?i.hash===_?(s.addClass("status--failed"),t()):(_=i.hash,void 0===i.selected_index&&(i.selected_index=e(".js-wizard-demo-import-select").val()||0),jQuery.post(i.url,i,n).fail(n)):(i.done,t())):(console.log(i),s.addClass("status--error"),t())}function i(){if(m){var i=l.find("input:checkbox");i.is(":checked")?jQuery.post(wizard_params.ajaxurl,{action:"wizard_content",wpnonce:wizard_params.wpnonce,content:m,selected_index:e(".js-wizard-demo-import-select").val()||0},n).fail(n):(l.addClass("skipping"),setTimeout(t,300))}}function t(){var n=!1;l&&(l.data("done_item")||(u++,l.data("done_item",1)),l.find(".spinner").css("visibility","hidden"));var t=e(".wizard__drawer--import-content__list-item");e(".wizard__drawer--import-content__list-item input:checked");t.each(function(){""==m||n?(m=e(this).data("content"),l=e(this),i(),n=!1):e(this).data("content")==m&&(n=!0)}),u>=t.length&&r()}function s(){if(!e(".wizard__drawer--import-content__list-item .checkbox-content").is(":checked"))return!1;jQuery.post(wizard_params.ajaxurl,{action:"wizard_get_total_content_import_items",wpnonce:wizard_params.wpnonce,selected_index:e(".js-wizard-demo-import-select").val()||0},function(e){p=e.data,0<p&&(a(),d=setInterval(function(){f+=p/500,a()},1e3))})}function o(e,n,i){return Math.min(i,Math.max(n,e))}function a(){e(".js-wizard-progress-bar").css("width",f/p*100+"%");var n=o(f/p*100,0,99);e(".js-wizard-progress-bar-percentage").html(Math.round(n)+"%"),1==f/p&&clearInterval(d)}var r,l,d,c=e(".wizard__body"),u=0,m="",_="",f=1,p=0;return{init:function(n){e(".wizard__drawer--import-content").addClass("installing"),e(".wizard__drawer--import-content").find("input").prop("disabled",!0),r=function(){e.post(wizard_params.ajaxurl,{action:"wizard_import_finished",wpnonce:wizard_params.wpnonce,selected_index:e(".js-wizard-demo-import-select").val()||0}),setTimeout(function(){e(".js-wizard-progress-bar-percentage").html("100%")},100),setTimeout(function(){c.removeClass(drawer_opened)},500),setTimeout(function(){e(".wizard__body").addClass("js--finished")},1500),setTimeout(function(){e(".wizard__body").addClass("exiting")},3400),setTimeout(function(){window.location.href=n.href},4e3)},s(),t()}}}function a(e){var n=jQuery(e);if("yes"==n.data("done-loading"))return!1;n.is("input")||n.is("button");return n.data("done-loading","yes"),n.addClass("wizard__button--loading"),{done:function(){!0,n.attr("disabled",!1)}}}var r={install_child:function(e){var n=new i;n.init(e)},activate_license:function(e){var n=new t;n.init(e)},install_plugins:function(e){var n=new s;n.init(e)},install_content:function(e){var n=new o;n.init(e)}};return{init:function(){this,e(n)},callback:function(e){console.log(e),console.log(this)}}}(jQuery);Wizard.init();